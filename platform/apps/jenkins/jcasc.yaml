# Jenkins Configuration as Code (JCasC) - security + Kubernetes agents
jenkins:
  systemMessage: "Fawkes CI (MVP)"
  mode: NORMAL
  # Kubernetes cloud configuration for ephemeral agents
  clouds:
    - kubernetes:
        name: "kubernetes"
        namespace: "fawkes"
        jenkinsUrl: "http://jenkins:8080"
        jenkinsTunnel: "jenkins-agent:50000"
        containerCapStr: "10"
        templates:
          - name: "jnlp-agent"
            label: "k8s-agent"
            remoteFs: "/home/jenkins"
            instanceCapStr: "5"
            idleTerminationMinutes: 10
            containers:
              - name: "jnlp"
                image: "jenkins/inbound-agent:latest"
                args: "${computer.jnlpmac} ${computer.name}"
                workingDir: "/home/jenkins"

securityRealm:
  local:
    allowsSignup: false
    users:
      - id: "admin"
        password: "${ADMIN_PASSWORD}"  # injected from k8s Secret

authorizationStrategy:
  loggedInUsersCanDoAnything:
    allowAnonymousRead: false

unclassified:
  location:
    adminAddress: "ci-admin@fawkes.local"
