# Copyright (c) 2025  Philip Ruff
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all
# copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
# EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
# IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
# DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
# OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE
# OR OTHER DEALINGS IN THE SOFTWARE.

# ============================================================================
# FILE: platform/apps/backstage/plugins/feedback-widget.yaml
# PURPOSE: Enhanced feedback widget plugin configuration for Backstage
#          Supports screenshot capture, GitHub integration, and contextual feedback
# ============================================================================
apiVersion: v1
kind: ConfigMap
metadata:
  name: backstage-feedback-plugin
  namespace: fawkes
  labels:
    app: backstage
    component: plugin
    plugin: feedback-widget
    environment: dev
    team: platform
data:
  plugin-config.yaml: |
    # Enhanced Feedback Widget Plugin Configuration
    # This plugin allows users to submit contextual feedback with screenshots
    # and automatically create GitHub issues

    feedback:
      enabled: true
      apiEndpoint: /feedback/api

      # Feedback categories
      categories:
        - UI/UX
        - Performance
        - Documentation
        - Features
        - Bug Report
        - Other

      # Feedback types (determines how feedback is handled)
      feedbackTypes:
        - id: feedback
          label: General Feedback
          description: Share your thoughts and suggestions
          icon: comment
          createGitHubIssue: false
        - id: bug_report
          label: Bug Report
          description: Report a problem or error
          icon: bug
          createGitHubIssue: true
        - id: feature_request
          label: Feature Request
          description: Suggest a new feature or improvement
          icon: lightbulb
          createGitHubIssue: true

      # API endpoints
      submitEndpoint: /api/v1/feedback
      adminEndpoint: /api/v1/feedback
      statsEndpoint: /api/v1/feedback/stats
      screenshotEndpoint: /api/v1/feedback/{id}/screenshot

      # Feature flags
      features:
        screenshotCapture: true
        githubIntegration: true
        contextualInfo: true
        sentimentAnalysis: true

      # Screenshot settings
      screenshot:
        enabled: true
        maxSizeMB: 5
        format: png
        quality: 0.9

      # GitHub integration settings
      github:
        enabled: true
        autoCreateIssue: true
        autoCreateForTypes:
          - bug_report
          - feature_request
        labels:
          - feedback
          - automated
