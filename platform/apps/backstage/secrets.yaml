# ============================================================================
# FILE: platform/apps/backstage/secrets.yaml
# PURPOSE: Kubernetes Secrets for Backstage integrations
#          Contains OAuth credentials, API tokens, and integration secrets.
# NOTE: For production, use External Secrets Operator to pull from Vault.
#       CHANGE ALL VALUES BEFORE DEPLOYING TO ANY ENVIRONMENT.
# ============================================================================
apiVersion: v1
kind: Secret
metadata:
  name: backstage-oauth-credentials
  namespace: fawkes
  labels:
    app: backstage
    component: developer-portal
    environment: dev
    team: platform
type: Opaque
stringData:
  # ============================================================================
  # GitHub OAuth App Credentials
  # ============================================================================
  # 
  # Setup Instructions:
  # 1. Create OAuth App at: https://github.com/settings/developers
  #    - For organizations: https://github.com/organizations/YOUR_ORG/settings/applications
  # 
  # 2. Configure OAuth App:
  #    Application name: Fawkes Backstage - [Environment]
  #    Homepage URL: https://backstage.fawkes.idp (or your Backstage URL)
  #    Authorization callback URL: https://backstage.fawkes.idp/api/auth/github/handler/frame
  #    
  #    IMPORTANT: The callback URL must match exactly, including:
  #    - Protocol (http vs https)
  #    - Domain name
  #    - Path: /api/auth/github/handler/frame
  # 
  # 3. After creating the OAuth app:
  #    - Copy the Client ID
  #    - Generate and copy the Client Secret (shown only once)
  # 
  # 4. Update values below with your credentials
  # 
  # 5. Apply to cluster:
  #    kubectl apply -f platform/apps/backstage/secrets.yaml
  # 
  # 6. Restart Backstage:
  #    kubectl rollout restart deployment/backstage -n fawkes
  # 
  # For detailed instructions, see: docs/how-to/security/github-oauth-setup.md
  # ============================================================================
  github-client-id: CHANGE_ME_github_oauth_client_id
  github-client-secret: CHANGE_ME_github_oauth_client_secret
---
apiVersion: v1
kind: Secret
metadata:
  name: backstage-github-credentials
  namespace: fawkes
  labels:
    app: backstage
    component: developer-portal
    environment: dev
    team: platform
type: Opaque
stringData:
  # ============================================================================
  # GitHub Personal Access Token (PAT) for Repository Integration
  # ============================================================================
  # 
  # This token is used for:
  # - Repository discovery and catalog ingestion
  # - Reading repository metadata
  # - Scaffolder actions (creating repos, pushing code)
  # 
  # Setup Instructions:
  # 1. Create PAT at: https://github.com/settings/tokens/new
  #    
  # 2. Token name: Fawkes Backstage Integration - [Environment]
  # 
  # 3. Select scopes:
  #    Required scopes:
  #    - repo (Full control of private repositories)
  #      Or just: repo:status, repo_deployment, public_repo (for public repos only)
  #    - read:org (Read org and team membership)
  #    - read:user (Read user profile data)
  #    - user:email (Access user email addresses)
  #    
  #    Optional (for full features):
  #    - workflow (Update GitHub Action workflows) - if using GitHub Actions
  #    - write:packages (Upload packages to GitHub Package Registry) - if needed
  # 
  # 4. Generate token and copy it immediately (shown only once)
  # 
  # 5. Update the value below
  # 
  # 6. Apply and restart:
  #    kubectl apply -f platform/apps/backstage/secrets.yaml
  #    kubectl rollout restart deployment/backstage -n fawkes
  # 
  # Note: For organizations, consider using a GitHub App instead of PAT
  #       for better security and permissions management.
  # 
  # See: https://backstage.io/docs/integrations/github/locations
  # ============================================================================
  token: CHANGE_ME_github_personal_access_token
---
apiVersion: v1
kind: Secret
metadata:
  name: backstage-argocd-credentials
  namespace: fawkes
  labels:
    app: backstage
    component: developer-portal
    environment: dev
    team: platform
type: Opaque
stringData:
  # ArgoCD credentials for deployment status integration
  username: admin
  password: CHANGE_ME_argocd_admin_password
  token: CHANGE_ME_argocd_api_token
---
apiVersion: v1
kind: Secret
metadata:
  name: backstage-jenkins-credentials
  namespace: fawkes
  labels:
    app: backstage
    component: developer-portal
    environment: dev
    team: platform
type: Opaque
stringData:
  # Jenkins credentials for CI/CD pipeline integration
  username: admin
  api-key: CHANGE_ME_jenkins_api_token
