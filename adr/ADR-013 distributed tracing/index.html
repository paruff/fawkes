
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Internal Developer Platform for Elite Performance">
      
      
      
      
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>ADR-013: Distributed Tracing for Platform and Applications - Fawkes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adr-013-distributed-tracing-for-platform-and-applications" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Fawkes" class="md-header__button md-logo" aria-label="Fawkes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Fawkes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ADR-013: Distributed Tracing for Platform and Applications
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/assessment.md" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../capabilities/fast-flow.md" class="md-tabs__link">
          
  
  
    
  
  Capabilities

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../patterns/" class="md-tabs__link">
          
  
  
    
  
  Patterns

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tools/" class="md-tabs__link">
          
  
  
    
  
  Tools

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Fawkes" class="md-nav__button md-logo" aria-label="Fawkes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Fawkes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/assessment.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Assessment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/implementation-paths.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Implementation Paths
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/quick-wins.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Wins
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Capabilities
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Capabilities
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../capabilities/fast-flow.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fast Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../capabilities/fast-feedback.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fast Feedback
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../capabilities/fast-recovery.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fast Recovery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../patterns/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Patterns
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Patterns
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/continuous-delivery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Continuous Delivery
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/infrastructure-as-code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure as Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/test-automation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Test Automation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../patterns/monitoring.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tools/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Continuous Delivery
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Continuous Delivery
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/spinnaker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Spinnaker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/jenkins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jenkins
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Infrastructure
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/terraform.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Terraform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/kubernetes.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Monitoring
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Monitoring
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/prometheus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prometheus
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/grafana.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grafana
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Status
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#decision" class="md-nav__link">
    <span class="md-ellipsis">
      
        Decision
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Decision">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Architecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-components" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Components
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trace-context-propagation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trace Context Propagation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sampling-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sampling Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instrumentation-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Instrumentation Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dora-metrics-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        DORA Metrics Integration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-with-existing-observability" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration with Existing Observability
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        Consequences
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Consequences">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#positive" class="md-nav__link">
    <span class="md-ellipsis">
      
        Positive
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#negative" class="md-nav__link">
    <span class="md-ellipsis">
      
        Negative
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neutral" class="md-nav__link">
    <span class="md-ellipsis">
      
        Neutral
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternatives-considered" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternatives Considered
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternatives Considered">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alternative-1-grafana-tempo" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 1: Grafana Tempo
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-2-zipkin" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 2: Zipkin
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-3-elastic-apm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 3: Elastic APM
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-4-aws-x-ray-cloud-provider-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 4: AWS X-Ray / Cloud Provider Tracing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-5-lightstep-honeycomb-commercial-saas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 5: Lightstep / Honeycomb (Commercial SaaS)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alternative-6-opentelemetry-collector-only-no-backend" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alternative 6: OpenTelemetry Collector Only (No Backend)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-plan" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Plan
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-mvp-week-6-of-sprint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 1: MVP (Week 6 of Sprint)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-core-services-week-7" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 2: Core Services (Week 7)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-application-support-week-8" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 3: Application Support (Week 8)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-documentation-training-week-9" class="md-nav__link">
    <span class="md-ellipsis">
      
        Phase 4: Documentation &amp; Training (Week 9)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dojo-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Dojo Integration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dojo Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#brown-belt-module-2-distributed-tracing-observability" class="md-nav__link">
    <span class="md-ellipsis">
      
        Brown Belt - Module 2: "Distributed Tracing &amp; Observability"
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monitoring &amp; Operations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring &amp; Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jaeger-health-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Jaeger Health Metrics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#grafana-dashboard-panels" class="md-nav__link">
    <span class="md-ellipsis">
      
        Grafana Dashboard Panels
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alerting-rules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alerting Rules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#operational-runbook" class="md-nav__link">
    <span class="md-ellipsis">
      
        Operational Runbook
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Security Considerations
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sensitive-data-in-traces" class="md-nav__link">
    <span class="md-ellipsis">
      
        Sensitive Data in Traces
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-control" class="md-nav__link">
    <span class="md-ellipsis">
      
        Access Control
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-retention" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Retention
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cost-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cost Analysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cost Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#infrastructure-costs-aws-medium-platform" class="md-nav__link">
    <span class="md-ellipsis">
      
        Infrastructure Costs (AWS, Medium Platform)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cost-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      
        Cost Comparison
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentation-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Documentation Structure
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Documentation Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#for-platform-teams" class="md-nav__link">
    <span class="md-ellipsis">
      
        For Platform Teams
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="adr-013-distributed-tracing-for-platform-and-applications">ADR-013: Distributed Tracing for Platform and Applications</h1>
<h2 id="status">Status</h2>
<p>Accepted</p>
<h2 id="context">Context</h2>
<p>Modern distributed systems like the Fawkes platform consist of numerous interconnected services where a single user request may traverse multiple components:</p>
<p><strong>Typical Request Flow Examples</strong>:
1. <strong>Developer Portal Access</strong>:
   - User → NGINX Ingress → Backstage → PostgreSQL
   - Backstage → GitHub API → ArgoCD API → Kubernetes API</p>
<ol>
<li><strong>CI/CD Pipeline Execution</strong>:</li>
<li>Git commit → Webhook → Jenkins → Docker build → Harbor push</li>
<li>
<p>Jenkins → SonarQube scan → ArgoCD trigger → Kubernetes deployment</p>
</li>
<li>
<p><strong>Application Deployment</strong>:</p>
</li>
<li>ArgoCD → Git repository → Kubernetes API → Container runtime</li>
<li>Health checks → Prometheus → Grafana → Alert Manager</li>
</ol>
<p><strong>Challenges Without Distributed Tracing</strong>:
- Difficult to identify performance bottlenecks across services
- Cannot determine which service in chain causes latency
- Hard to correlate logs from different services for single request
- No visibility into service dependencies and call patterns
- Troubleshooting production issues requires manual log aggregation
- Cannot measure end-to-end request latency accurately
- Difficulty identifying cascading failures
- No insight into retry/timeout behaviors</p>
<p><strong>Requirements</strong>:
- Trace requests across all platform services (Backstage, Jenkins, ArgoCD, Mattermost)
- Support for application tracing (polyglot: Java, Python, Node.js, Go)
- Low overhead (&lt;5% performance impact)
- Open standards (OpenTelemetry preferred)
- Integration with existing observability stack (Prometheus, Grafana)
- Sampling strategies to control data volume
- Context propagation across async operations (queues, webhooks)
- Trace retention (7-30 days for analysis)
- Query and visualization capabilities
- Correlation with logs and metrics
- Works across Kubernetes namespaces and clusters</p>
<p><strong>Use Cases for Fawkes</strong>:
1. <strong>Platform Operations</strong>: Trace deployment pipeline from git commit to running pod
2. <strong>Performance Optimization</strong>: Identify slow database queries or API calls
3. <strong>Incident Response</strong>: Quickly identify failing service in request chain
4. <strong>Capacity Planning</strong>: Understand service call patterns and volumes
5. <strong>Dojo Learning</strong>: Teach distributed systems concepts with real traces
6. <strong>DORA Metrics</strong>: Accurate lead time measurement (commit to deploy)</p>
<p><strong>Security &amp; Privacy</strong>:
- Traces must not contain sensitive data (passwords, tokens, PII)
- Access control for trace data by team/namespace
- Sampling to prevent excessive data collection
- Data retention policies for compliance</p>
<p><strong>Operational Constraints</strong>:
- Must work with existing OpenTelemetry collector (from ADR-012)
- Should integrate with Grafana for unified observability
- Must support auto-instrumentation for common frameworks
- Low operational overhead (minimal configuration)
- Cost-effective storage for trace data</p>
<h2 id="decision">Decision</h2>
<p>We will use <strong>Jaeger</strong> as the distributed tracing backend, with <strong>OpenTelemetry</strong> as the instrumentation standard, creating a unified observability stack.</p>
<h3 id="architecture">Architecture</h3>
<div class="highlight"><pre><span></span><code>┌─────────────────────────────────────────────────────────────────┐
│  Application &amp; Platform Services                                 │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │ Backstage    │  │ Jenkins      │  │ ArgoCD       │          │
│  │ (OTel SDK)   │  │ (OTel Agent) │  │ (OTel SDK)   │          │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘          │
│         │                  │                  │                   │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │ User App 1   │  │ User App 2   │  │ User App 3   │          │
│  │ (Java)       │  │ (Python)     │  │ (Node.js)    │          │
│  │ OTel Agent   │  │ OTel Agent   │  │ OTel Agent   │          │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘          │
│         │                  │                  │                   │
│         └──────────────────┴──────────────────┘                  │
│                            │                                      │
│                            ▼ OTLP (gRPC/HTTP)                    │
│         ┌──────────────────────────────────────────┐            │
│         │ OpenTelemetry Collector (Daemonset)      │            │
│         │ - Receives spans via OTLP                 │            │
│         │ - Batching &amp; sampling                     │            │
│         │ - Context propagation                     │            │
│         │ - Span enrichment (k8s metadata)          │            │
│         └──────────────┬───────────────────────────┘            │
│                        │                                          │
└────────────────────────┼──────────────────────────────────────────┘
                         │
                         ▼ Jaeger format
         ┌──────────────────────────────────────────┐
         │ Jaeger Collector (Service)               │
         │ - Validates spans                        │
         │ - Applies sampling policies              │
         │ - Writes to storage backend              │
         └──────────────┬───────────────────────────┘
                        │
                        ▼
         ┌──────────────────────────────────────────┐
         │ Storage Backend                          │
         │ ┌────────────────┐  ┌────────────────┐  │
         │ │ OpenSearch     │  │ Cassandra      │  │
         │ │ (MVP choice)   │  │ (Alternative)  │  │
         │ └────────────────┘  └────────────────┘  │
         │ - Trace data indexed                     │
         │ - 7-day retention (configurable)         │
         │ - Compressed storage                     │
         └──────────────┬───────────────────────────┘
                        │
                        ▼
         ┌──────────────────────────────────────────┐
         │ Jaeger Query Service (UI)                │
         │ - Search traces by service/operation     │
         │ - Visualize trace timelines              │
         │ - Dependency graphs                      │
         │ - Performance analytics                  │
         └──────────────┬───────────────────────────┘
                        │
                        ▼
         ┌──────────────────────────────────────────┐
         │ Grafana (via Jaeger Data Source)        │
         │ - Unified observability dashboard        │
         │ - Correlate traces with logs &amp; metrics   │
         │ - Custom trace-based alerts              │
         └──────────────────────────────────────────┘
</code></pre></div>
<h3 id="key-components">Key Components</h3>
<p><strong>1. OpenTelemetry SDKs/Agents</strong> (Application Layer):
- <strong>Auto-instrumentation</strong>: Java, Python, Node.js, .NET, Go, Ruby
- <strong>Manual instrumentation</strong>: Custom spans for business logic
- <strong>Context propagation</strong>: W3C Trace Context headers
- <strong>Sampling</strong>: Configurable at application level</p>
<p><strong>2. OpenTelemetry Collector</strong> (Already deployed from ADR-012):
- <strong>Receiver</strong>: OTLP (gRPC port 4317, HTTP port 4318)
- <strong>Processor</strong>: Batch processing, tail sampling, span enrichment
- <strong>Exporter</strong>: Jaeger (gRPC to Jaeger collector)
- <strong>Kubernetes metadata</strong>: Automatic pod/namespace/service labeling</p>
<p><strong>3. Jaeger Collector</strong>:
- Receives spans from OpenTelemetry Collector
- Applies sampling strategies (adaptive, rate-limiting)
- Validates span data and enforces schemas
- Writes to OpenSearch backend</p>
<p><strong>4. Jaeger Query Service</strong>:
- REST API for trace retrieval
- Web UI for trace visualization
- Service dependency graph generation
- Support for lookback queries (find similar slow traces)</p>
<p><strong>5. Storage - OpenSearch</strong>:
- Reuses existing OpenSearch cluster (from ADR-011)
- Separate indices for traces (<code>jaeger-span-*</code>)
- 7-day retention (configurable to 30 days)
- Index templates for automatic management</p>
<p><strong>6. Grafana Integration</strong>:
- Jaeger data source plugin
- Trace-to-log correlation (clicking span opens related logs)
- Trace-to-metrics correlation (RED metrics by trace)
- Exemplars (link from metric spike to example trace)</p>
<h3 id="trace-context-propagation">Trace Context Propagation</h3>
<p><strong>Standard</strong>: W3C Trace Context (traceparent/tracestate headers)</p>
<div class="highlight"><pre><span></span><code>traceparent: 00-4bf92f3577b34da6a3ce929d0e0e4736-00f067aa0ba902b7-01
             ││ └────────────── trace-id ──────────────┘ └─ span-id ─┘ │
             │└────────────────────────────────────────────────────────┘
             └─ version                                     trace-flags ┘

Example HTTP request:
GET /api/projects HTTP/1.1
Host: backstage.fawkes.example.com
traceparent: 00-4bf92f3577b34da6a3ce929d0e0e4736-00f067aa0ba902b7-01
</code></pre></div>
<p><strong>Propagation Across Services</strong>:
1. Ingress creates root span, generates trace-id
2. Backstage receives trace-id, creates child span
3. Backstage calls GitHub API, propagates trace-id
4. All spans linked by trace-id in Jaeger</p>
<h3 id="sampling-strategy">Sampling Strategy</h3>
<p><strong>Head-Based Sampling</strong> (at application/collector):
- <strong>Always Sample</strong>: Error traces (status code 5xx)
- <strong>Rate Limiting</strong>: 100 traces/second per service (prevents overwhelming backend)
- <strong>Probabilistic</strong>: Sample 10% of normal traffic (1 in 10 requests)
- <strong>Configurable by service</strong>: Critical services 100%, others 10%</p>
<p><strong>Tail-Based Sampling</strong> (at collector - optional):
- Keep all error traces
- Keep all slow traces (&gt;1s duration)
- Sample 10% of successful fast traces</p>
<p><strong>Production Configuration</strong>:
<div class="highlight"><pre><span></span><code><span class="c1"># OpenTelemetry Collector - tail_sampling processor</span>
<span class="nt">tail_sampling</span><span class="p">:</span>
<span class="w">  </span><span class="nt">decision_wait</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10s</span><span class="w">  </span><span class="c1"># Wait for all spans in trace</span>
<span class="w">  </span><span class="nt">num_traces</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100000</span><span class="w">  </span><span class="c1"># Memory limit</span>
<span class="w">  </span><span class="nt">policies</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">error-traces</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">status_code</span>
<span class="w">      </span><span class="nt">status_code</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">status_codes</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">ERROR</span><span class="p p-Indicator">]}</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slow-traces</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">latency</span>
<span class="w">      </span><span class="nt">latency</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">threshold_ms</span><span class="p">:</span><span class="w"> </span><span class="nv">1000</span><span class="p p-Indicator">}</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">probabilistic-sample</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">probabilistic</span>
<span class="w">      </span><span class="nt">probabilistic</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">sampling_percentage</span><span class="p">:</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">}</span>
</code></pre></div></p>
<h3 id="instrumentation-strategy">Instrumentation Strategy</h3>
<p><strong>Platform Services</strong> (MVP):
1. <strong>Backstage</strong>: OpenTelemetry JavaScript SDK
2. <strong>Jenkins</strong>: OpenTelemetry Java Agent (no code changes)
3. <strong>ArgoCD</strong>: Native OTLP support (configuration only)
4. <strong>NGINX Ingress</strong>: OpenTelemetry module (creates root spans)
5. <strong>Mattermost</strong>: OpenTelemetry Go SDK</p>
<p><strong>Application Support</strong> (for user workloads):
1. <strong>Java</strong>: OpenTelemetry Java Agent (auto-instrumentation)
   <div class="highlight"><pre><span></span><code>java<span class="w"> </span>-javaagent:/opt/opentelemetry-javaagent.jar<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-Dotel.service.name<span class="o">=</span>my-app<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-Dotel.exporter.otlp.endpoint<span class="o">=</span>http://otel-collector:4317<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-jar<span class="w"> </span>app.jar
</code></pre></div></p>
<ol>
<li>
<p><strong>Python</strong>: OpenTelemetry Python auto-instrumentation
   <div class="highlight"><pre><span></span><code>opentelemetry-instrument<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--traces_exporter<span class="w"> </span>otlp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--service_name<span class="w"> </span>my-app<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>python<span class="w"> </span>app.py
</code></pre></div></p>
</li>
<li>
<p><strong>Node.js</strong>: OpenTelemetry JS SDK
   <div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NodeSDK</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;@opentelemetry/sdk-node&#39;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">sdk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">NodeSDK</span><span class="p">({</span>
<span class="w">  </span><span class="nx">serviceName</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;my-app&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">traceExporter</span><span class="o">:</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">OTLPTraceExporter</span><span class="p">()</span>
<span class="p">});</span>
<span class="nx">sdk</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Go</strong>: OpenTelemetry Go SDK (manual instrumentation)
   <div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="s">&quot;go.opentelemetry.io/otel&quot;</span>

<span class="nx">tracer</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">otel</span><span class="p">.</span><span class="nx">Tracer</span><span class="p">(</span><span class="s">&quot;my-service&quot;</span><span class="p">)</span>
<span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">span</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">tracer</span><span class="p">.</span><span class="nx">Start</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;operation-name&quot;</span><span class="p">)</span>
<span class="k">defer</span><span class="w"> </span><span class="nx">span</span><span class="p">.</span><span class="nx">End</span><span class="p">()</span>
</code></pre></div></p>
</li>
</ol>
<p><strong>Auto-Instrumentation via Kubernetes Operator</strong> (Post-MVP):
- OpenTelemetry Operator auto-injects agents via mutating webhook
- Developers annotate pods: <code>instrumentation.opentelemetry.io/inject-java: "true"</code>
- Zero code changes required</p>
<h3 id="dora-metrics-integration">DORA Metrics Integration</h3>
<p><strong>Lead Time for Changes</strong> - Enhanced with tracing:
1. Webhook creates trace when commit pushed to main
2. Trace follows through: Jenkins build → Harbor push → ArgoCD sync → Pod running
3. Calculate exact end-to-end duration from trace timeline
4. More accurate than timestamp differencing (accounts for retries, waits)</p>
<p><strong>Change Failure Rate</strong> - Trace-based detection:
- Identify failed deployments by error spans in deployment traces
- Correlate with rollback traces
- Tag traces with deployment result (success/failure)</p>
<p><strong>Mean Time to Restore</strong> - Incident tracing:
- Create trace when incident detected (alert fires)
- Trace follows incident response: diagnosis → fix deployment → verification
- Measure actual restoration timeline with trace duration</p>
<h3 id="integration-with-existing-observability">Integration with Existing Observability</h3>
<p><strong>Trace-to-Metrics Correlation</strong>:
<div class="highlight"><pre><span></span><code><span class="c1"># Find traces for requests with high latency</span>
<span class="kr">histogram_quantile</span><span class="o">(</span><span class="mf">0.95</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="kr">rate</span><span class="o">(</span><span class="nv">http_request_duration_seconds_bucket</span><span class="p">[</span><span class="s">5m</span><span class="p">]</span><span class="o">)</span>
<span class="o">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span>

<span class="c1"># Grafana displays exemplar traces for this metric</span>
</code></pre></div></p>
<p><strong>Trace-to-Log Correlation</strong>:
- Inject trace-id into application logs (structured logging)
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-12-07T10:15:30Z&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;level&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ERROR&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Database connection failed&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;trace_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;4bf92f3577b34da6a3ce929d0e0e4736&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;span_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;00f067aa0ba902b7&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;service&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;backstage&quot;</span>
<span class="p">}</span>
</code></pre></div>
- OpenSearch query by trace-id retrieves all logs for trace
- Grafana "Explore" view: click trace span → view logs</p>
<p><strong>Service Dependency Mapping</strong>:
- Jaeger automatically generates service dependency graph from traces
- Shows call volume and error rates between services
- Updated in real-time as traces arrive
- Helps identify critical path and single points of failure</p>
<h2 id="consequences">Consequences</h2>
<h3 id="positive">Positive</h3>
<ol>
<li><strong>Complete Visibility</strong>: End-to-end request tracing across all services</li>
<li><strong>Fast Troubleshooting</strong>: Identify failing service in seconds vs. hours</li>
<li><strong>Performance Optimization</strong>: Pinpoint exact bottleneck (slow DB query, external API)</li>
<li><strong>DORA Accuracy</strong>: Precise lead time measurement from commit to production</li>
<li><strong>Unified Observability</strong>: Trace-log-metric correlation in single Grafana view</li>
<li><strong>Standards-Based</strong>: OpenTelemetry ensures vendor neutrality and broad support</li>
<li><strong>Low Barrier</strong>: Auto-instrumentation requires minimal developer effort</li>
<li><strong>Educational Value</strong>: Excellent teaching tool for distributed systems in dojo</li>
<li><strong>Service Mapping</strong>: Auto-generated dependency graphs show architecture reality</li>
<li><strong>Cost Effective</strong>: Open source stack, reuses OpenSearch storage</li>
</ol>
<h3 id="negative">Negative</h3>
<ol>
<li><strong>Storage Costs</strong>: Traces consume significant storage (7-day retention ~500GB for medium platform)</li>
<li><strong>Performance Overhead</strong>: 2-5% latency increase from span creation and propagation</li>
<li><strong>Complexity</strong>: Additional component (Jaeger) to operate and maintain</li>
<li><strong>Sampling Tradeoffs</strong>: 10% sampling means missing 90% of requests (may miss rare issues)</li>
<li><strong>Learning Curve</strong>: Developers must understand spans, context propagation, sampling</li>
<li><strong>Data Volume</strong>: High traffic services generate millions of spans per day</li>
<li><strong>Manual Instrumentation</strong>: Custom business logic requires manual span creation</li>
<li><strong>Context Propagation</strong>: Async operations (queues, workers) require careful header passing</li>
</ol>
<h3 id="neutral">Neutral</h3>
<ol>
<li><strong>OpenSearch Dependency</strong>: Reuses existing cluster, but adds index management complexity</li>
<li><strong>Jaeger vs. Alternatives</strong>: Could use Tempo or Zipkin, but Jaeger more mature</li>
<li><strong>Sampling Required</strong>: Cannot trace 100% of requests at scale (cost/performance prohibitive)</li>
<li><strong>Multi-Cluster</strong>: Tracing across clusters requires federation (future consideration)</li>
</ol>
<h2 id="alternatives-considered">Alternatives Considered</h2>
<h3 id="alternative-1-grafana-tempo">Alternative 1: Grafana Tempo</h3>
<p><strong>Pros</strong>:
- Native Grafana integration (same vendor)
- Extremely cost-efficient (uses object storage)
- Simpler architecture (no separate query service)
- Scales to billions of spans
- Tag-based querying (no need for index)</p>
<p><strong>Cons</strong>:
- Less mature than Jaeger (launched 2020 vs. 2015)
- Limited query capabilities (no full-text search)
- Requires external object storage (S3, GCS, Azure Blob)
- Smaller community and fewer integrations
- UI less polished than Jaeger</p>
<p><strong>Reason for Rejection</strong>: While Tempo is promising, Jaeger's maturity, rich query capabilities, and built-in UI make it better for MVP. Tempo's strength (object storage efficiency) is less critical for Fawkes' scale. Can migrate to Tempo post-MVP if storage costs become issue.</p>
<h3 id="alternative-2-zipkin">Alternative 2: Zipkin</h3>
<p><strong>Pros</strong>:
- Pioneer in distributed tracing (created by Twitter 2012)
- Simple architecture (fewer moving parts)
- Battle-tested at scale
- Multiple storage backends (MySQL, Cassandra, OpenSearch)
- Good documentation and examples</p>
<p><strong>Cons</strong>:
- Less active development than Jaeger/Tempo
- UI feels dated compared to modern tools
- Limited advanced features (no tail sampling, basic analytics)
- OpenTelemetry support added later (not native)
- Smaller community momentum</p>
<p><strong>Reason for Rejection</strong>: Zipkin is solid but feels "last generation." Jaeger has more momentum, better OpenTelemetry integration, and richer feature set. For educational platform, modern tooling is preferable.</p>
<h3 id="alternative-3-elastic-apm">Alternative 3: Elastic APM</h3>
<p><strong>Pros</strong>:
- Integrated with Elastic Stack (logs, metrics, traces in one)
- Excellent UI and visualizations
- Powerful querying (Elasticsearch under hood)
- Machine learning anomaly detection
- Application performance monitoring features beyond tracing</p>
<p><strong>Cons</strong>:
- <strong>Licensing concerns</strong>: Elastic License 2.0 (not open source)
- Vendor lock-in to Elastic ecosystem
- Higher resource requirements than Jaeger
- More complex architecture (APM Server + Elasticsearch + Kibana)
- Cost considerations for Elastic Cloud</p>
<p><strong>Reason for Rejection</strong>: Elastic APM is feature-rich but introduces licensing concerns and vendor lock-in. Fawkes prioritizes open source (Apache 2.0) and cloud-agnostic tooling. Also conflicts with using OpenSearch (Elasticsearch fork) elsewhere.</p>
<h3 id="alternative-4-aws-x-ray-cloud-provider-tracing">Alternative 4: AWS X-Ray / Cloud Provider Tracing</h3>
<p><strong>Pros</strong>:
- Fully managed (no infrastructure to maintain)
- Native cloud integration (Lambda, ECS, etc.)
- Built-in sampling and cost controls
- Tight integration with cloud services</p>
<p><strong>Cons</strong>:
- <strong>Cloud vendor lock-in</strong> (violates Fawkes portability principle)
- Cannot run on-premises or in learner laptops
- Inconsistent across AWS/Azure/GCP
- Less suitable for teaching (managed service abstracts details)
- Cost unpredictable at scale</p>
<p><strong>Reason for Rejection</strong>: Same reason as cloud ingress controllers (ADR-010). Fawkes must work anywhere. Dojo learners need local tracing stack. Platform teams need cloud-agnostic solution.</p>
<h3 id="alternative-5-lightstep-honeycomb-commercial-saas">Alternative 5: Lightstep / Honeycomb (Commercial SaaS)</h3>
<p><strong>Pros</strong>:
- Exceptional user experience
- Advanced features (Service Level Objectives, intelligent sampling)
- Minimal operational overhead (fully managed)
- Excellent performance at massive scale</p>
<p><strong>Cons</strong>:
- <strong>Commercial pricing</strong> (cost prohibitive for open source project)
- Data leaves cluster (security/privacy concerns)
- Not self-hosted option
- Vendor lock-in
- Antithetical to Fawkes open source values</p>
<p><strong>Reason for Rejection</strong>: Fawkes is open source platform for self-hosting. Commercial SaaS doesn't align with principles. Organizations using Fawkes can choose commercial observability, but platform itself must be self-contained.</p>
<h3 id="alternative-6-opentelemetry-collector-only-no-backend">Alternative 6: OpenTelemetry Collector Only (No Backend)</h3>
<p><strong>Pros</strong>:
- Minimal complexity (already deploying OTel Collector)
- Export to any backend later
- No storage costs
- Flexible backend choice</p>
<p><strong>Cons</strong>:
- <strong>No trace visualization</strong> (cannot view traces)
- No query capability (useless for troubleshooting)
- Defeats purpose of distributed tracing
- Cannot demonstrate value to learners
- DORA metrics incomplete without trace analysis</p>
<p><strong>Reason for Rejection</strong>: Tracing without storage and visualization provides no value. Like installing Prometheus without Grafana. Backend is essential for distributed tracing ROI.</p>
<h2 id="implementation-plan">Implementation Plan</h2>
<h3 id="phase-1-mvp-week-6-of-sprint">Phase 1: MVP (Week 6 of Sprint)</h3>
<ol>
<li><strong>Deploy Jaeger Components</strong> [4 hours]</li>
<li>Install Jaeger Operator via Helm</li>
<li>Configure Jaeger instance with OpenSearch backend</li>
<li>Deploy Jaeger Query Service and UI</li>
<li>
<p>Configure Ingress (https://tracing.fawkes.example.com)</p>
</li>
<li>
<p><strong>Configure OpenTelemetry Collector</strong> [2 hours]</p>
</li>
<li>Add Jaeger exporter to existing OTel Collector</li>
<li>Configure tail sampling processor</li>
<li>Test OTLP → Jaeger pipeline</li>
<li>
<p>Verify spans appearing in Jaeger UI</p>
</li>
<li>
<p><strong>Instrument NGINX Ingress</strong> [2 hours]</p>
</li>
<li>Enable OpenTelemetry module</li>
<li>Configure to create root spans</li>
<li>Propagate trace context headers</li>
<li>
<p>Test end-to-end tracing</p>
</li>
<li>
<p><strong>Instrument Backstage</strong> [3 hours]</p>
</li>
<li>Add OpenTelemetry JavaScript SDK</li>
<li>Configure OTLP exporter</li>
<li>Add custom spans for catalog operations</li>
<li>Test trace visualization</li>
</ol>
<h3 id="phase-2-core-services-week-7">Phase 2: Core Services (Week 7)</h3>
<ol>
<li><strong>Instrument Jenkins</strong> [3 hours]</li>
<li>Deploy OpenTelemetry Java Agent</li>
<li>Configure Jenkins JVM parameters</li>
<li>Create spans for build stages</li>
<li>
<p>Test pipeline tracing</p>
</li>
<li>
<p><strong>Instrument ArgoCD</strong> [2 hours]</p>
</li>
<li>Enable native OTLP export (if available)</li>
<li>OR configure OTel sidecar</li>
<li>Trace sync operations</li>
<li>
<p>Test deployment tracing</p>
</li>
<li>
<p><strong>Grafana Integration</strong> [3 hours]</p>
</li>
<li>Add Jaeger data source to Grafana</li>
<li>Configure trace-to-log correlation</li>
<li>Add trace exemplars to metric dashboards</li>
<li>Create combined observability dashboard</li>
</ol>
<h3 id="phase-3-application-support-week-8">Phase 3: Application Support (Week 8)</h3>
<ol>
<li><strong>Create Auto-Instrumentation Guides</strong> [4 hours]</li>
<li>Java application instrumentation guide</li>
<li>Python application instrumentation guide</li>
<li>Node.js application instrumentation guide</li>
<li>
<p>Go application instrumentation guide (manual)</p>
</li>
<li>
<p><strong>Deploy Sample Instrumented Apps</strong> [3 hours]</p>
</li>
<li>Java Spring Boot with OTel agent</li>
<li>Python FastAPI with auto-instrumentation</li>
<li>Node.js Express with OTel SDK</li>
<li>
<p>Test cross-service tracing</p>
</li>
<li>
<p><strong>DORA Metrics Integration</strong> [4 hours]</p>
<ul>
<li>Create trace-based lead time calculator</li>
<li>Tag deployment traces with result</li>
<li>Integrate trace data into DORA dashboard</li>
<li>Test end-to-end measurement</li>
</ul>
</li>
</ol>
<h3 id="phase-4-documentation-training-week-9">Phase 4: Documentation &amp; Training (Week 9)</h3>
<ol>
<li>
<p><strong>Documentation</strong> [6 hours]</p>
<ul>
<li>Architecture overview with diagrams</li>
<li>Instrumentation best practices</li>
<li>Troubleshooting guide (common issues)</li>
<li>Query and visualization guide</li>
</ul>
</li>
<li>
<p><strong>Dojo Module - Brown Belt</strong> [4 hours]</p>
<ul>
<li>Module: "Distributed Tracing &amp; Observability"</li>
<li>Hands-on lab: Instrument custom application</li>
<li>Exercise: Debug slow request with traces</li>
<li>Assessment on tracing concepts</li>
</ul>
</li>
</ol>
<h2 id="dojo-integration">Dojo Integration</h2>
<h3 id="brown-belt-module-2-distributed-tracing-observability">Brown Belt - Module 2: "Distributed Tracing &amp; Observability"</h3>
<p><strong>Learning Objectives</strong>:
- Understand distributed tracing concepts (spans, traces, context propagation)
- Instrument applications with OpenTelemetry
- Use Jaeger UI to analyze traces and identify bottlenecks
- Correlate traces with logs and metrics
- Apply sampling strategies appropriately</p>
<p><strong>Hands-On Lab</strong> (90 minutes):
1. <strong>Setup</strong>: Deploy pre-built microservices application (3 services)
2. <strong>Problem</strong>: Application is slow, identify bottleneck
3. <strong>Instrument</strong>: Add OpenTelemetry to each service
4. <strong>Analyze</strong>: Find slow database query in traces
5. <strong>Fix</strong>: Optimize query, verify improvement in traces
6. <strong>Advanced</strong>: Add custom spans for business operations</p>
<p><strong>Lab Architecture</strong>:
<div class="highlight"><pre><span></span><code>┌──────────┐     ┌──────────┐     ┌──────────┐
│ Frontend │ ──&gt; │ API      │ ──&gt; │ Database │
│ (Node)   │     │ (Python) │     │ (Postgres│
└──────────┘     └──────────┘     └──────────┘
     │                │                 │
     └────────────────┴─────────────────┘
                      │
                      ▼
              Trace everything!
</code></pre></div></p>
<p><strong>Assessment</strong>:
- Quiz on tracing concepts (10 questions)
- Practical: Debug performance issue using traces
- Code review: Evaluate instrumentation quality</p>
<h2 id="monitoring-operations">Monitoring &amp; Operations</h2>
<h3 id="jaeger-health-metrics">Jaeger Health Metrics</h3>
<p>Monitor via Prometheus:
<div class="highlight"><pre><span></span><code><span class="c1"># Jaeger Collector metrics</span>
<span class="l l-Scalar l-Scalar-Plain">jaeger_collector_spans_received_total</span>
<span class="l l-Scalar l-Scalar-Plain">jaeger_collector_spans_saved_total</span>
<span class="l l-Scalar l-Scalar-Plain">jaeger_collector_spans_dropped_total</span>
<span class="l l-Scalar l-Scalar-Plain">jaeger_collector_queue_length</span>

<span class="l l-Scalar l-Scalar-Plain"># Jaeger Query metrics</span>
<span class="l l-Scalar l-Scalar-Plain">jaeger_query_requests_total</span>
<span class="l l-Scalar l-Scalar-Plain">jaeger_query_latency_seconds</span>
</code></pre></div></p>
<h3 id="grafana-dashboard-panels">Grafana Dashboard Panels</h3>
<p><strong>Jaeger Operations Dashboard</strong>:
1. Spans received per second (by service)
2. Span save success rate
3. Collector queue depth
4. Query latency (P95, P99)
5. Storage usage (OpenSearch indices)
6. Most traced services (top 10)
7. Sampling rate by service</p>
<h3 id="alerting-rules">Alerting Rules</h3>
<div class="highlight"><pre><span></span><code><span class="nt">groups</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jaeger_alerts</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HighSpanDropRate</span>
<span class="w">    </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rate(jaeger_collector_spans_dropped_total[5m]) / rate(jaeger_collector_spans_received_total[5m]) &gt; 0.01</span>
<span class="w">    </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10m</span>
<span class="w">    </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">      </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Jaeger</span><span class="nv"> </span><span class="s">dropping</span><span class="nv"> </span><span class="s">&gt;1%</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">spans&quot;</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Check</span><span class="nv"> </span><span class="s">collector</span><span class="nv"> </span><span class="s">resources</span><span class="nv"> </span><span class="s">and</span><span class="nv"> </span><span class="s">storage</span><span class="nv"> </span><span class="s">backend&quot;</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">JaegerCollectorDown</span>
<span class="w">    </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">up{job=&quot;jaeger-collector&quot;} == 0</span>
<span class="w">    </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5m</span>
<span class="w">    </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">      </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Jaeger</span><span class="nv"> </span><span class="s">Collector</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">down&quot;</span>

<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">alert</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HighQueryLatency</span>
<span class="w">    </span><span class="nt">expr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">histogram_quantile(0.95, jaeger_query_latency_seconds_bucket) &gt; 5</span>
<span class="w">    </span><span class="nt">for</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10m</span>
<span class="w">    </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">      </span><span class="nt">summary</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Jaeger</span><span class="nv"> </span><span class="s">Query</span><span class="nv"> </span><span class="s">P95</span><span class="nv"> </span><span class="s">latency</span><span class="nv"> </span><span class="s">&gt;5s&quot;</span>
</code></pre></div>
<h3 id="operational-runbook">Operational Runbook</h3>
<p><strong>Trace Data Volume Too High</strong>:
1. Increase sampling percentage (reduce from 10% to 5%)
2. Apply tail sampling (keep only slow/error traces)
3. Reduce retention (7 days → 3 days)
4. Scale OpenSearch cluster (more data nodes)</p>
<p><strong>Missing Traces</strong>:
1. Check OTel Collector exporter config (OTLP → Jaeger)
2. Verify Jaeger Collector receiving spans (Prometheus metrics)
3. Check application instrumentation (SDK configured?)
4. Verify sampling (maybe sampled out?)
5. Check network connectivity (firewall rules)</p>
<p><strong>Slow Trace Queries</strong>:
1. Check OpenSearch cluster health (yellow/red status?)
2. Optimize indices (force merge, reindex)
3. Add more Jaeger Query replicas
4. Implement query caching</p>
<h2 id="security-considerations">Security Considerations</h2>
<h3 id="sensitive-data-in-traces">Sensitive Data in Traces</h3>
<p><strong>Problem</strong>: Traces may inadvertently capture passwords, tokens, PII</p>
<p><strong>Mitigation</strong>:
1. <strong>Sanitize at source</strong>: Remove sensitive fields before creating spans
   <div class="highlight"><pre><span></span><code><span class="c1"># BAD</span>
<span class="n">span</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;sql.query&quot;</span><span class="p">,</span> <span class="s2">&quot;SELECT * FROM users WHERE password=&#39;secret123&#39;&quot;</span><span class="p">)</span>

<span class="c1"># GOOD</span>
<span class="n">span</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;sql.query&quot;</span><span class="p">,</span> <span class="s2">&quot;SELECT * FROM users WHERE password=&#39;[REDACTED]&#39;&quot;</span><span class="p">)</span>
</code></pre></div></p>
<ol>
<li>
<p><strong>OTel Collector processor</strong>: Scrub sensitive attributes
   <div class="highlight"><pre><span></span><code><span class="nt">processors</span><span class="p">:</span>
<span class="w">  </span><span class="nt">attributes/sanitize</span><span class="p">:</span>
<span class="w">    </span><span class="nt">actions</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http.request.header.authorization</span>
<span class="w">        </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">db.statement</span>
<span class="w">        </span><span class="nt">pattern</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password=.*</span>
<span class="w">        </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">replace</span>
<span class="w">        </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password=[REDACTED]</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Developer training</strong>: Educate on what NOT to trace</p>
</li>
</ol>
<h3 id="access-control">Access Control</h3>
<p><strong>Jaeger UI</strong>: Integrate with OAuth2 proxy (same as other platform services)
- Platform teams: Full access to all traces
- Application teams: Access to their namespace traces only (via Jaeger Query filters)</p>
<p><strong>Grafana</strong>: Role-based access control
- Developers see traces for their services
- Platform SREs see all traces</p>
<h3 id="data-retention">Data Retention</h3>
<p><strong>Compliance</strong>: 
- Default 7-day retention meets most needs
- Extend to 30 days for compliance (SOC 2 requires evidence retention)
- Automate deletion via OpenSearch ILM policies</p>
<h2 id="cost-analysis">Cost Analysis</h2>
<h3 id="infrastructure-costs-aws-medium-platform">Infrastructure Costs (AWS, Medium Platform)</h3>
<p><strong>Jaeger Components</strong>:
- Jaeger Collector (3 replicas): 1 CPU × 3 = $40/month
- Jaeger Query (2 replicas): 0.5 CPU × 2 = $13/month</p>
<p><strong>Storage</strong> (OpenSearch):
- Trace data: ~500GB for 7-day retention at 10% sampling
- Cost: 500GB × $0.10/GB (GP3) = $50/month</p>
<p><strong>Network</strong>:
- Data transfer (spans): Minimal (&lt;$10/month, intra-VPC)</p>
<p><strong>Total Monthly Cost</strong>: ~$113/month</p>
<p><strong>Cost Optimization</strong>:
- Reduce sampling (10% → 5%) = 50% storage savings
- Shorter retention (7 days → 3 days) = 57% storage savings
- Use S3 for cold storage (&gt;7 days) = 90% savings on old traces</p>
<h3 id="cost-comparison">Cost Comparison</h3>
<table>
<thead>
<tr>
<th>Solution</th>
<th>Monthly Cost</th>
<th>Storage</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Jaeger + OpenSearch</td>
<td>$113</td>
<td>500GB</td>
<td>Self-hosted, full control</td>
</tr>
<tr>
<td>Grafana Tempo + S3</td>
<td>$70</td>
<td>Unlimited</td>
<td>Object storage efficient</td>
</tr>
<tr>
<td>Elastic APM</td>
<td>$200+</td>
<td>500GB</td>
<td>Enterprise features</td>
</tr>
<tr>
<td>Datadog APM</td>
<td>$500+</td>
<td>Unlimited</td>
<td>SaaS, easy but expensive</td>
</tr>
<tr>
<td>AWS X-Ray</td>
<td>$150</td>
<td>N/A</td>
<td>Managed, AWS-only</td>
</tr>
</tbody>
</table>
<h2 id="documentation-structure">Documentation Structure</h2>
<h3 id="for-platform-teams">For Platform Teams</h3>
<ol>
<li><strong>Architecture Guide</strong></li>
<li>Trace flow d</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight"], "search": "../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>